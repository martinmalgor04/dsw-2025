ALCANCE DEL SISTEMA - M√ìDULO DE TRANSPORTE, LOG√çSTICA Y SEGUIMIENTO

1. DEFINICI√ìN GENERAL
Sistema de gesti√≥n log√≠stica que opera en modelo punto a punto (A‚ÜíB): retira mercader√≠a en dep√≥sitos de Stock y entrega directamente al cliente final, sin sucursales intermedias ni centros de distribuci√≥n propios.
Responsabilidad: Coordinar y ejecutar el traslado f√≠sico de productos desde el dep√≥sito hasta el cliente.
No responsabilidad: Venta, cobro, gesti√≥n de inventario, atenci√≥n comercial.

2. L√çMITES DEL SISTEMA
2.1 LO QUE EL SISTEMA S√ç HACE ‚úÖ
Operaciones Core:
Cotizar costo y tiempo de env√≠o antes de la compra
Crear y registrar env√≠os post-compra
Planificar retiros en dep√≥sitos de Stock
Coordinar y ejecutar retiros f√≠sicos con documentaci√≥n
Planificar rutas de entrega optimizadas (√∫ltima milla)
Ejecutar entregas con evidencia digital opcional (firma/foto)
Gestionar problemas, reintentos y reprogramaciones
Procesar cancelaciones (dentro de ventana permitida)
Gestionar devoluciones a Stock cuando corresponda
Mantener trazabilidad completa consultable v√≠a API
Generar documentaci√≥n operativa (etiquetas, actas, POD)
Gesti√≥n y Control:
Configuraci√≥n de zonas de cobertura, veh√≠culos y capacidades
Configuraci√≥n de tarifas y reglas de cotizaci√≥n
Torre de control y reportes operativos
Administraci√≥n de usuarios y permisos
Auditor√≠a de operaciones
Integraciones:
API REST con Portal de Compras (cotizaci√≥n, creaci√≥n, tracking, cancelaci√≥n)
API REST con Stock (consulta productos, validaci√≥n reservas)

2.2 LO QUE EL SISTEMA NO HACE ‚ùå
Fuera de Alcance:
‚ùå Venta de productos (lo hace Portal de Compras)
‚ùå Gesti√≥n de cat√°logo (lo hace Portal de Compras)
‚ùå Cobro de env√≠os (lo cobra Portal de Compras)
‚ùå Gesti√≥n de inventario (lo hace Stock)
‚ùå Almacenamiento propio (usamos dep√≥sitos de Stock)
‚ùå Sucursales de retiro para clientes (no operamos pick-up points)
‚ùå Cross-docking o consolidaci√≥n (retiramos y entregamos directo)
‚ùå Env√≠os entre sucursales (no aplica, no hay sucursales)
‚ùå Log√≠stica inversa de cambios comerciales (solo devoluciones por inentregabilidad)
‚ùå Notificaciones push al cliente final (las env√≠a Portal de Compras)
‚ùå Gesti√≥n de reclamos comerciales (lo gestiona Portal de Compras)
‚ùå Facturaci√≥n al cliente (la genera Portal de Compras)

3. ACTORES Y RESPONSABILIDADES
3.1 SISTEMAS EXTERNOS (Integrados v√≠a API)
Portal de Compras:
Solicita cotizaciones antes de la compra
Crea env√≠os tras confirmaci√≥n de orden
Consulta estados mediante GET /shipping/{id} (polling)
Solicita cancelaciones (dentro de ventana)
Obtiene POD para mostrar al cliente
Responsable de: liberar reservas en Stock tras cancelaci√≥n o retiro
Stock:
Expone informaci√≥n de productos (peso, dimensiones, dep√≥sito)
Mantiene reservas de mercader√≠a
Libera reservas cuando Portal lo solicita
NO recibe: confirmaciones de retiro f√≠sico, notificaciones de devoluci√≥n

3.2 ROLES INTERNOS
Operaci√≥n Log√≠stica - Base:
Planifica rutas de retiro en dep√≥sitos
Asigna env√≠os a veh√≠culos y conductores
Optimiza hojas de reparto (√∫ltima milla)
Programa franjas horarias
Monitorea operaci√≥n en curso
Conductor:
Ejecuta retiros en dep√≥sitos de Stock
Ejecuta entregas al cliente (con o sin app m√≥vil)
Captura evidencias (firma digital, fotos) - opcional seg√∫n implementaci√≥n
Reporta problemas de entrega con motivo estandarizado
Backoffice de Problemas:
Gestiona env√≠os no entregados
Corrige datos err√≥neos (direcci√≥n, tel√©fono)
Reprograma reintentos
Prioriza casos urgentes
Decide devoluciones a Stock
Administrador General:
Configura red log√≠stica completa
Define zonas de cobertura y tarifas
Administra veh√≠culos y capacidades
Gestiona usuarios y permisos
Accede a reportes estrat√©gicos y auditor√≠a

4. FLUJO OPERATIVO COMPLETO
4.1 FLUJO PRINCIPAL (Sin Incidencias)
1. COTIZACI√ìN PREVIA
   Portal ‚Üí Log√≠stica: POST /shipping/cost
   Log√≠stica ‚Üí Stock: GET /productos/{id} (por cada producto)
   Log√≠stica ‚Üí Portal: Precio + ETA estimado

2. CREACI√ìN DE ENV√çO
   Cliente confirma compra en Portal
   Portal ‚Üí Stock: POST /reservas (reserva productos)
   Portal ‚Üí Log√≠stica: POST /shipping (crea env√≠o, recibe shipping_id)
   Log√≠stica ‚Üí Stock: GET /reservas/{id} (valida reserva activa)
   Log√≠stica: Crea env√≠o, estado = "created", calcula ETA

3. PROGRAMACI√ìN DE RETIRO
   Operaci√≥n Base: Agrupa env√≠os por dep√≥sito
   Operaci√≥n Base: Asigna veh√≠culo + conductor + franja horaria
   Log√≠stica: Estado = "pickup_scheduled"

4. RETIRO EN DEP√ìSITO
   Conductor: Llega al dep√≥sito
   Conductor: Retira mercader√≠a (con/sin escaneo seg√∫n implementaci√≥n)
   Conductor: Genera acta de retiro con firma de Stock
   Log√≠stica: Estado = "picked_up"
   Portal: Consulta GET /shipping/{id} ‚Üí ve estado actualizado

5. PLANIFICACI√ìN DE ENTREGA
   Operaci√≥n Base: Asigna a hoja de reparto del d√≠a
   Operaci√≥n Base: Optimiza ruta (m√∫ltiples paradas)
   Log√≠stica: Estado = "out_for_delivery"

6. EJECUCI√ìN DE ENTREGA
   Conductor: Navega a direcci√≥n del cliente
   Conductor: Entrega paquete
   Conductor: Captura evidencia (firma/foto - opcional)
   Log√≠stica: Estado = "delivered", genera POD
   Portal: Consulta GET /shipping/{id} ‚Üí ve entrega confirmada

7. CIERRE
   Portal: Actualiza orden como "Entregada"
   Cliente: Consulta tracking + descarga POD (si disponible)
```

---

### 4.2 FLUJOS ALTERNATIVOS (Desv√≠os)

**A. Cancelaci√≥n Temprana:**
```
Cliente: Cancela compra
Portal ‚Üí Log√≠stica: POST /shipping/{id}/cancel
Log√≠stica: Valida estado = "created" o "pickup_scheduled"
Log√≠stica: Estado = "cancelled"
Portal ‚Üí Stock: DELETE /reservas/{id} (libera reserva)
```

**B. No Entregado (Primer Intento):**
```
Conductor: Llega a direcci√≥n ‚Üí Cliente ausente
Conductor: Marca "delivery_failed - Ausente" + foto evidencia
Log√≠stica: Estado = "delivery_failed"
Backoffice: Reprograma para d√≠a siguiente
Log√≠stica: Estado = "out_for_delivery" (reintento)
```

**C. Correcci√≥n de Datos:**
```
Backoffice: Detecta direcci√≥n incorrecta
Backoffice: Contacta cliente, corrige datos
Backoffice: Actualiza env√≠o con nueva direcci√≥n
Backoffice: Reprograma entrega
```

**D. Devoluci√≥n a Stock:**
```
Backoffice: Env√≠o con 3 intentos fallidos, inentregable
Backoffice: Marca estado = "returning"
‚ö†Ô∏è Coordinaci√≥n manual con Stock (email/tel√©fono)
Conductor: Lleva al dep√≥sito, genera acta devoluci√≥n con firma Stock
Log√≠stica: Estado = "returned"
‚ö†Ô∏è Stock reintegra inventario manualmente en su sistema
```

---

## 5. ESTADOS DEL ENV√çO

### 5.1 Estados Principales

| Estado | Descripci√≥n | Responsable |
|--------|-------------|-------------|
| **created** | Env√≠o registrado, pendiente de programar retiro | Sistema |
| **pickup_scheduled** | Retiro asignado a veh√≠culo/conductor/franja | Operaci√≥n Base |
| **picking_up** | Conductor en el dep√≥sito (opcional) | Conductor |
| **picked_up** | Mercader√≠a retirada de Stock | Conductor |
| **out_for_delivery** | En ruta hacia cliente | Operaci√≥n Base |
| **delivered** | Cliente recibi√≥ el paquete | Conductor |
| **delivery_failed** | Intento fallido, requiere acci√≥n | Conductor |
| **cancelled** | Cancelado antes del retiro | Portal/Sistema |
| **returning** | En tr√°nsito de regreso a Stock | Backoffice |
| **returned** | Devuelto a Stock | Conductor |

---

### 5.2 Transiciones de Estado
```
created ‚Üí pickup_scheduled ‚Üí picking_up ‚Üí picked_up ‚Üí 
out_for_delivery ‚Üí delivered ‚úÖ

Desv√≠os:
created ‚Üí cancelled ‚ùå
pickup_scheduled ‚Üí cancelled ‚ùå
out_for_delivery ‚Üí delivery_failed ‚Üí out_for_delivery (reintento)
delivery_failed ‚Üí returning ‚Üí returned ‚ùå
```

---

## 6. COMUNICACIONES ENTRE SUBSISTEMAS

### 6.1 APIs que EXPONEMOS (Log√≠stica ‚Üí Externos)

**Para Portal de Compras:**
```
POST /shipping/cost
  ‚Üí Cotiza env√≠o
  ‚Üê Devuelve precio + ETA

POST /shipping
  ‚Üí Crea env√≠o post-compra
  ‚Üê Devuelve shipping_id + estado + ETA

GET /shipping/{id}
  ‚Üí Consulta estado y tracking
  ‚Üê Devuelve estado actual + historial + ETA

POST /shipping/{id}/cancel
  ‚Üí Cancela env√≠o (solo si estado permite)
  ‚Üê Confirma cancelaci√≥n

GET /shipping/{id}/pod
  ‚Üí Obtiene POD (Proof of Delivery)
  ‚Üê Devuelve URL del documento
```

**Modelo de comunicaci√≥n:**
- **NO hay webhooks** implementados
- Portal hace **polling** consultando GET /shipping/{id} peri√≥dicamente
- Portal se encarga de actualizar su propia base de datos

---

### 6.2 APIs que CONSUMIMOS (Log√≠stica ‚Üí Externos)

**De Stock:**
```
GET /productos/{id}
  ‚Üí Consulta peso, dimensiones, dep√≥sito de origen
  ‚Üê Devuelve caracter√≠sticas del producto

GET /reservas/{id}?usuarioId={X}
  ‚Üí Valida existencia y estado de reserva
  ‚Üê Devuelve estado + productos reservados
De Portal (indirectamente):
Portal llama a Stock: DELETE /reservas/{id} para liberar reservas
Log√≠stica NO llama directamente a Stock para liberar

7. REGLAS DE NEGOCIO CR√çTICAS
7.1 Cotizaci√≥n
‚úÖ Precio = tarifa base + (peso volum√©trico √ó tarifa/kg) + (distancia √ó tarifa/km)
‚úÖ Peso volum√©trico = MAX(peso real, (largo√óancho√óalto)/factor)
‚úÖ ETA = pr√≥ximo slot de retiro + tiempo tr√°nsito + buffer operativo
‚úÖ Cotizaci√≥n v√°lida por tiempo configurable
‚ùå No cotiza si direcci√≥n fuera de zona de cobertura

7.2 Creaci√≥n de Env√≠o
‚úÖ Solo se crea si existe reserva activa en Stock
‚úÖ ETA inicial considera carga operativa actual
‚ùå Rechaza si reserva caduc√≥ o productos no coinciden
‚ùå Rechaza si direcci√≥n fuera de cobertura
‚úÖ Devuelve shipping_id √∫nico al Portal

7.3 Retiro
‚úÖ Retiro debe estar dentro de ventana operativa del dep√≥sito
‚úÖ Genera acta de retiro con firma de responsable de Stock
‚úÖ Estado cambia a "picked_up" al confirmar
‚ùå Stock NO recibe notificaci√≥n autom√°tica del retiro f√≠sico

7.4 Planificaci√≥n de Entrega
‚úÖ Suma de peso/volumen ‚â§ capacidad del veh√≠culo
‚úÖ Rutas se optimizan por proximidad geogr√°fica (opcional)
‚úÖ Se respetan franjas horarias comprometidas (si hay)
‚ö†Ô∏è Alerta si utilizaci√≥n > 90% de capacidad
‚ùå Bloquea asignaci√≥n si excede 100%

7.5 Entrega
‚úÖ Entrega exitosa puede incluir firma digital y/o foto (seg√∫n implementaci√≥n)
‚úÖ POD incluye geolocalizaci√≥n si est√° disponible
‚úÖ "delivery_failed" requiere motivo estandarizado obligatorio
‚úÖ Estado "delivered" disponible para consulta v√≠a API

7.6 Cancelaci√≥n
‚úÖ Cancelaci√≥n permitida SOLO si estado = "created" o "pickup_scheduled"
‚ùå No se puede cancelar si estado ‚â• "picking_up"
‚úÖ Portal es responsable de liberar reserva en Stock (DELETE /reservas/{id})
‚úÖ Estado cambia a "cancelled"

7.7 Reintentos
‚úÖ M√°ximo de intentos configurable (ej: 3)
‚úÖ Ventana de reintento configurable (ej: 5 d√≠as desde creaci√≥n)
‚ö†Ô∏è Alerta si se alcanza m√°ximo de intentos
‚úÖ Backoffice decide: nuevo reintento o devoluci√≥n

7.8 Devoluci√≥n
‚úÖ Solo aplica si env√≠o inentregable tras agotar reintentos
‚úÖ Requiere autorizaci√≥n de Backoffice
‚úÖ Genera acta de devoluci√≥n firmada por Stock
‚ö†Ô∏è Coordinaci√≥n manual con Stock para reintegrar inventario (no hay API)

8. DOCUMENTOS GENERADOS
Documento
Cu√°ndo
Contenido
Formato
Etiqueta
Al crear env√≠o
ID env√≠o, c√≥digo barras, direcci√≥n
PDF
Acta de Retiro
Al retirar de Stock
Lista productos, firma Stock
PDF
Hoja de Reparto
Al planificar entrega
Paradas ordenadas, contactos
PDF
POD
Al entregar
Firma/foto + geolocalizaci√≥n
PDF + im√°genes
Acta de Devoluci√≥n
Al devolver a Stock
Motivo, firma Stock
PDF


9. RESTRICCIONES Y SUPUESTOS
9.1 Restricciones T√©cnicas
‚úÖ APIs REST con timeout m√°ximo 10 segundos
‚úÖ Respuesta de cotizaci√≥n < 3 segundos
‚úÖ API de tracking < 500ms
‚úÖ App m√≥vil puede funcionar offline (seg√∫n implementaci√≥n)
‚úÖ Retenci√≥n de datos: m√≠nimo 1 a√±o
9.2 Restricciones Operativas
‚úÖ Solo operamos en zonas configuradas
‚úÖ Solo retiramos de dep√≥sitos de Stock
‚úÖ No hacemos cross-docking (retiro y entrega son separados)
‚úÖ No almacenamos mercader√≠a (todo en tr√°nsito)
‚úÖ No hay webhooks (Portal hace polling)
9.3 Supuestos
‚úÖ Portal tiene sistema de notificaciones al cliente final
‚úÖ Portal es responsable de liberar reservas en Stock
‚úÖ Stock mantiene inventario actualizado
‚úÖ Conductores tienen acceso a la operaci√≥n (app, papel, radio, etc.)
‚úÖ Dep√≥sitos de Stock tienen personal en ventanas operativas
‚úÖ Clientes proveen direcci√≥n v√°lida al comprar

11. FUERA DE ALCANCE ACTUAL
Limitaciones conocidas:
Con Stock:
üî¥ Stock NO tiene endpoint para confirmar retiro f√≠sico
üî¥ Stock NO tiene endpoint para recibir devoluciones f√≠sicas
‚ö†Ô∏è Coordinaci√≥n manual requerida para devoluciones

12. RESPONSABILIDADES ENTRE SUBSISTEMAS
Portal de Compras
‚úÖ Venta y cobro al cliente
‚úÖ Crear reservas en Stock
‚úÖ Liberar reservas en Stock (tras cancelaci√≥n o retiro)
‚úÖ Consultar estado de env√≠os (polling)
‚úÖ Notificar al cliente final
‚úÖ Gestionar reclamos comerciales
Stock
‚úÖ Gesti√≥n de inventario
‚úÖ Crear y mantener reservas
‚úÖ Liberar reservas cuando Portal solicita
‚úÖ Exponer informaci√≥n de productos
‚ùå NO recibe confirmaciones de retiro f√≠sico
‚ùå NO recibe notificaciones de devoluci√≥n
Log√≠stica (este sistema)
‚úÖ Cotizar env√≠os
‚úÖ Crear y gestionar env√≠os
‚úÖ Validar reservas en Stock
‚úÖ Coordinar y ejecutar retiros f√≠sicos
‚úÖ Planificar y ejecutar entregas
‚úÖ Gestionar problemas y reintentos
‚úÖ Generar documentaci√≥n operativa
‚úÖ Proveer tracking v√≠a API (polling)
‚ùå NO libera reservas en Stock (lo hace Portal)
‚ùå NO notifica autom√°ticamente a Stock retiros/devoluciones
13. COMUNICACIONES ENTRE SUBSISTEMAS
1. Cotizaci√≥n (Pre-compra)
Portal ‚Üí Log√≠stica: POST /shipping/cost (direcci√≥n + productos)
Log√≠stica ‚Üí Stock: GET /productos/{id} (consulta peso, dimensiones, almac√©n por cada producto)
2. Creaci√≥n de Env√≠o (Post-compra)
Portal ‚Üí Stock: POST /reservas (crea reserva de productos)
Portal ‚Üí Log√≠stica: POST /shipping (crea env√≠o, recibe shipping_id)
Log√≠stica ‚Üí Stock: GET /reservas/{id}?usuarioId=X (valida que reserva existe y est√° activa)
3. Tracking (Consulta de estado)
Portal ‚Üí Log√≠stica: GET /shipping/{id} (consulta estado actual + historial de eventos)
Portal realiza polling peri√≥dico para actualizar estados
4. Cancelaci√≥n
Portal ‚Üí Log√≠stica: POST /shipping/{id}/cancel (cancela el env√≠o)
Portal ‚Üí Stock: DELETE /reservas/{id} (libera la reserva para que mercader√≠a quede disponible)
5. Estados del Env√≠o
Flujo de estados en Log√≠stica:
created ‚Üí pickup_scheduled ‚Üí picking_up ‚Üí picked_up ‚Üí 
out_for_delivery ‚Üí delivered / delivery_failed / cancelled / returning ‚Üí returned










14. Backlog de Historias de Usuario - M√≥dulo de Transporte, Log√≠stica y Seguimiento

√âPICAS
EP1 - Cotizaci√≥n Previa
Descripci√≥n: Calcular costos y tiempos de entrega consultando datos de Stock (peso, dimensiones, dep√≥sito de origen) y distancia a destino, devolviendo precio y ETA al Portal de Compras antes de que el cliente confirme la compra.
M√©tricas clave:
Tiempo de respuesta de cotizaci√≥n (< 3 seg)
% cotizaciones exitosas vs fallidas
Diferencia entre ETA cotizado vs real

EP2 - Creaci√≥n de Env√≠o Post-Compra
Descripci√≥n: Recibir orden confirmada del Portal de Compras, validar reserva activa en Stock, crear registro de env√≠o con ETA inicial y devolver shipping_id al Portal.
M√©tricas clave:
% env√≠os creados correctamente vs rechazados
Tiempo entre compra y creaci√≥n de env√≠o
% reservas validadas exitosamente

EP3 - Retiro en Dep√≥sito de Stock
Descripci√≥n: Planificar rutas de retiro, asignar veh√≠culos y conductores, ejecutar retiro con escaneo de productos y generar acta firmada.
M√©tricas clave:
% retiros en tiempo vs retrasados
Tiempo promedio de retiro en dep√≥sito
% discrepancias entre reservado y retirado

EP4 - Planificaci√≥n de √öltima Milla
Descripci√≥n: Asignar env√≠os retirados a veh√≠culos y turnos, optimizar rutas de entrega considerando capacidad, franjas horarias y proximidad geogr√°fica.
M√©tricas clave:
% utilizaci√≥n de capacidad vehicular
Cantidad promedio de paradas por ruta
Cumplimiento de franjas horarias prometidas

EP5 - Ejecuci√≥n de Entrega (App Conductor)
Descripci√≥n: Proveer herramienta m√≥vil para que conductores naveguen, contacten clientes, registren entregas exitosas con evidencia digital (firma/foto) o marquen no entregado con motivo estandarizado.
M√©tricas clave:
Tasa de √©xito en primer intento
Tiempo promedio por entrega
% uso de evidencia digital (firma/foto)

EP6 - Gesti√≥n de Problemas y Reintentos
Descripci√≥n: Administrar env√≠os no entregados, corregir datos err√≥neos, reprogramar entregas y priorizar reintentos.
M√©tricas clave:
% env√≠os resueltos en primer reintento
Tiempo promedio de resoluci√≥n de incidencias
Cantidad de reintentos por env√≠o

EP7 - Cancelaci√≥n y Devoluci√≥n
Descripci√≥n: Permitir cancelaci√≥n de env√≠os antes del retiro y gestionar devoluciones cuando corresponda retornar mercader√≠a al dep√≥sito.
M√©tricas clave:
% cancelaciones dentro de ventana permitida
Tiempo de liberaci√≥n de reserva post-cancelaci√≥n
% devoluciones completadas exitosamente

EP8 - Seguimiento, Eventos y Documentos
Descripci√≥n: Mantener l√≠nea de tiempo detallada de cada env√≠o consultable v√≠a API, recalcular ETAs cuando ocurren demoras, generar y compartir documentos operativos (etiquetas, actas, POD).
M√©tricas clave:
Tiempo de respuesta de API de tracking (< 500ms)
Precisi√≥n de ETAs actualizados
% documentos generados sin error

EP9 - Torre de Control y Reportes
Descripci√≥n: Generar reportes de desempe√±o, KPIs operativos y auditor√≠a completa por env√≠o.
M√©tricas clave:
Tiempo de detecci√≥n de alertas cr√≠ticas
% cobertura de trazabilidad completa
Tiempo de generaci√≥n de reportes anal√≠ticos

EP10 - Configuraci√≥n Operativa y Seguridad
Descripci√≥n: Administrar maestros de zonas/CPs, veh√≠culos, capacidades, reglas de cotizaci√≥n, motivos de no entrega, roles y permisos de usuarios seg√∫n nivel de acceso.
M√©tricas clave:
% actualizaciones de configuraci√≥n sin incidentes
Tiempo de onboarding de nuevos usuarios
% auditor√≠as de acceso exitosas

HISTORIAS DE USUARIO POR √âPICA
EP1 - Cotizaci√≥n Previa
HU-ID: EP1-HU1
 Como Portal de Compras
 Quiero solicitar cotizaci√≥n enviando direcci√≥n de entrega y lista de productos
 Para ofrecer al cliente el costo y tiempo de env√≠o antes de confirmar la compra
Criterios de Aceptaci√≥n:
Recibe JSON con direcci√≥n completa (calle, n√∫mero, CP, ciudad) + array de productos (id, cantidad)
Valida formato de direcci√≥n y existencia de productos
Devuelve error 400 si faltan datos obligatorios o formato incorrecto
Timeout de 5 segundos, devuelve error 504 si no responde

HU-ID: EP1-HU2
 Como M√≥dulo de Log√≠stica
 Quiero consultar a Stock peso, dimensiones y dep√≥sito de origen por cada producto
 Para calcular capacidad necesaria y distancia real del retiro
Criterios de Aceptaci√≥n:
Llama API de Stock por cada producto √∫nico en la solicitud
Recibe peso (kg), dimensiones (cm¬≥) y c√≥digo de dep√≥sito
Cachea respuesta de Stock por 10 minutos para mismo producto
Si Stock no responde en 2 seg, usa valores por defecto y marca cotizaci√≥n como "estimada"

HU-ID: EP1-HU3
 Como M√≥dulo de Log√≠stica
 Quiero calcular precio de env√≠o seg√∫n peso volum√©trico, distancia y servicio seleccionado
 Para devolver tarifa correcta al Portal de Compras
Criterios de Aceptaci√≥n:
Calcula peso volum√©trico = (largo √ó ancho √ó alto) / factor configurado
Usa el mayor entre peso real y volum√©trico
Aplica tarifa base + tarifa por kg/km seg√∫n reglas configuradas por servicio
Redondea precio a 2 decimales
Devuelve precio en moneda configurada (ej: ARS)

HU-ID: EP1-HU4
 Como M√≥dulo de Log√≠stica
 Quiero estimar ETA sumando tiempo de retiro + tiempo de entrega
 Para informar al cliente cu√°ndo recibir√° su pedido
Criterios de Aceptaci√≥n:
Tiempo de retiro = pr√≥xima ventana disponible en dep√≥sito de Stock
Tiempo de entrega = distancia / velocidad promedio + tiempo de espera por zona
Considera d√≠as h√°biles y horarios operativos configurados
Devuelve ETA en formato ISO 8601 (fecha y hora)
Marca ETA como "estimado" si us√≥ valores por defecto

EP2 - Creaci√≥n de Env√≠o Post-Compra
HU-ID: EP2-HU1
 Como Portal de Compras
 Quiero crear env√≠o tras confirmaci√≥n de compra enviando orden, servicio y datos del cliente
 Para iniciar el proceso log√≠stico autom√°ticamente
Criterios de Aceptaci√≥n:
Recibe: ID orden, servicio contratado, direcci√≥n entrega completa, contacto (nombre, tel√©fono, email), lista de productos
Genera ID √∫nico de env√≠o (ej: ENV-20250101-00001)
Devuelve ID de env√≠o, estado inicial "created" y ETA
Almacena timestamp de creaci√≥n

HU-ID: EP2-HU2
 Como M√≥dulo de Log√≠stica
 Quiero validar que existe reserva activa en Stock para los productos del env√≠o
 Para asegurar que la mercader√≠a est√° disponible antes de planificar retiro
Criterios de Aceptaci√≥n:
Consulta API de Stock con ID de reserva
Verifica estado de reserva = "confirmado" y productos coincidentes
Si reserva no existe o caduc√≥, rechaza creaci√≥n con error 422
Si reserva v√°lida, contin√∫a con creaci√≥n de env√≠o
Registra ID de reserva asociado al env√≠o

HU-ID: EP2-HU3
 Como M√≥dulo de Log√≠stica
 Quiero calcular ETA inicial basado en disponibilidad de retiro y capacidad de entrega
 Para comprometer fecha realista con el cliente
Criterios de Aceptaci√≥n:
Consulta pr√≥xima ventana de retiro disponible en dep√≥sito
Estima tiempo de entrega seg√∫n zona y carga operativa actual
Suma buffers configurados (ej: +4hs por procesamiento)
Almacena ETA en BD con timestamp de c√°lculo
Permite recalcular ETA si condiciones cambian

EP3 - Retiro en Dep√≥sito de Stock
HU-ID: EP3-HU1
 Como Operaci√≥n Log√≠stica - Base
 Quiero ver env√≠os listos para retirar agrupados por dep√≥sito
 Para planificar rutas de retiro eficientes
Criterios de Aceptaci√≥n:
Lista muestra env√≠os con estado "created"
Agrupa por dep√≥sito de origen
Muestra: direcci√≥n dep√≥sito, cantidad de env√≠os, peso/volumen total
Permite seleccionar m√∫ltiples env√≠os para asignar a una misma ruta
Filtra por rango de fechas de compromiso de retiro

HU-ID: EP3-HU2
 Como Operaci√≥n Log√≠stica - Base
 Quiero asignar env√≠os a veh√≠culo, conductor y franja horaria de retiro
 Para coordinar la visita al dep√≥sito
Criterios de Aceptaci√≥n:
Selecciona veh√≠culo de lista activa con capacidad suficiente
Asigna conductor de lista disponible
Define franja horaria dentro de ventanas operativas del dep√≥sito
Valida que capacidad no exceda l√≠mite del veh√≠culo
Cambia estado de env√≠os a "pickup_scheduled"

HU-ID: EP3-HU3
 Como Conductor
 Quiero ver en mi app m√≥vil la hoja de retiro con direcci√≥n y lista de env√≠os
 Para saber qu√© retirar en cada dep√≥sito
Criterios de Aceptaci√≥n:
App muestra: direcci√≥n del dep√≥sito, contacto, horario de retiro
Lista de env√≠os asignados con: ID env√≠o, ID orden, productos, cantidad, peso
Opci√≥n de navegaci√≥n GPS al dep√≥sito
Opci√≥n de llamar al contacto del dep√≥sito
Estado de cada env√≠o visible (ej: pendiente de retiro)

HU-ID: EP3-HU4
 Como Conductor
 Quiero escanear c√≥digo de barras de carta de porte
 Para confirmar que estoy retirando lo correcto 
Criterios de Aceptaci√≥n:
App permite escanear c√≥digo de barras usando c√°mara del dispositivo
Valida que c√≥digo coincida con productos del env√≠o
Marca producto como escaneado (checkmark verde)
Permite ingreso manual si c√≥digo no escanea
Alerta si escanea producto no esperado
Muestra progreso: X de Y productos escaneados
cambiar estado a que el pedido esta retirado y en camino

EP4 - Planificaci√≥n de √öltima Milla
HU-ID: EP4-HU1
 Como Operaci√≥n Log√≠stica - Base
 Quiero ver env√≠os pendientes de entrega
 Para planificar entregas del d√≠a siguiente
Criterios de Aceptaci√≥n:
Lista env√≠os con estado "picked_up"
Filtra por zona de entrega (CP o pol√≠gono)
Muestra: ID env√≠o, direcci√≥n, peso, volumen, ETA comprometido
Ordena por urgencia (ETA m√°s cercano primero)
Permite selecci√≥n m√∫ltiple para asignar en lote

HU-ID: EP4-HU2
 Como Operaci√≥n Log√≠stica - Base
 Quiero asignar env√≠os a veh√≠culo y turno considerando capacidad m√°xima
 Para evitar sobrecarga y optimizar recursos
Criterios de Aceptaci√≥n:
Selecciona veh√≠culo y turno (ma√±ana/tarde/noche)
Sistema valida capacidad: suma peso y volumen de env√≠os ‚â§ capacidad veh√≠culo
Alerta si asignaci√≥n excede 90% de capacidad
Bloquea asignaci√≥n si excede 100%
Cambia estado de env√≠os a "out_for_delivery" al confirmar

HU-ID: EP4-HU5
 Como Conductor
 Quiero ver en app mi hoja de reparto con orden de paradas
 Para ejecutar las entregas eficientemente
Criterios de Aceptaci√≥n:
Lista de paradas numeradas en orden sugerido
Para cada parada: direcci√≥n, contacto, tel√©fono, referencias, horario preferido
Mapa con ruta trazada
Opci√≥n de navegaci√≥n GPS paso a paso
Indicador de progreso: X de Y entregas completadas

EP5 - Ejecuci√≥n de Entrega (App Conductor)
HU-ID: EP5-HU1
 Como Conductor
 Quiero ver detalle de cada parada al llegar
 Para confirmar datos y contactar al cliente
Criterios de Aceptaci√≥n:
Al tocar parada muestra: direcci√≥n completa, piso/depto, referencias
Nombre del destinatario, tel√©fono, email
Productos a entregar, cantidad de bultos
Instrucciones especiales (ej: "portero el√©ctrico c√≥digo 123")
Botones: Iniciar navegaci√≥n, Llamar cliente, Marcar entregado, No entregado

HU-ID: EP5-HU2
 Como Conductor
 Quiero marcar entrega como "Entregado"
 Para reportar que un pedido a sido entregado
Criterios de Aceptaci√≥n:
Cambia estado a "entregado"

HU-ID: EP5-HU3
 Como Conductor
 Quiero marcar entrega como "No entregado" seleccionando motivo estandarizado
 Para reportar claramente por qu√© no pude completar la entrega
Criterios de Aceptaci√≥n:
Lista de motivos predefinidos: Ausente, Direcci√≥n incorrecta, Rechaz√≥ el paquete, Zona insegura, Problemas con producto, Horario cerrado, Otro
Campo opcional de observaciones (m√°x 500 caracteres)
Permite tomar foto de evidencia (ej: negocio cerrado)
Captura geolocalizaci√≥n y timestamp
Cambia estado a "delivery_failed"
Env√≠o vuelve a bandeja de problemas

EP6 - Gesti√≥n de Problemas y Reintentos
HU-ID: EP6-HU1
 Como Backoffice de Problemas
 Quiero ver bandeja de env√≠os con estado "delivery_failed"
 Para priorizar resoluci√≥n de incidencias
Criterios de Aceptaci√≥n:
Lista env√≠os con estado "delivery_failed"
Columnas: ID env√≠o, orden, motivo, intentos previos, d√≠as desde creaci√≥n, ETA vencido (s√≠/no)
Filtra por motivo de no entrega
Ordena por urgencia (ETA vencido primero)
Indicador visual de env√≠os cr√≠ticos (>2 intentos fallidos)

HU-ID: EP6-HU3
 Como Backoffice de Problemas
 Quiero reprogramar env√≠o para reintento en fecha y franja espec√≠fica
 Para coordinar con disponibilidad del cliente
Criterios de Aceptaci√≥n:
Selecciona fecha futura (dentro de ventana permitida, ej: 5 d√≠as)
Selecciona franja horaria (ma√±ana/tarde)
Cambia estado a "out_for_delivery"
Env√≠o entra a planificaci√≥n del d√≠a seleccionado
Recalcula y almacena nuevo ETA
Registra n√∫mero de reintento

EP7 - Cancelaci√≥n y Devoluci√≥n
HU-ID: EP7-HU1
 Como Portal de Compras
 Quiero cancelar un env√≠o antes de que sea retirado del dep√≥sito
 Para permitir al cliente desistir de la compra sin impacto log√≠stico
Criterios de Aceptaci√≥n:
API acepta solicitud de cancelaci√≥n si estado = "created" o "pickup_scheduled"
Rechaza cancelaci√≥n si estado >= "picking_up" (c√≥digo 422)
Cambia estado a "cancelled"
Response incluye: shipping_id, status: "cancelled", cancelled_at

HU-ID: EP7-HU3
 Como Operaci√≥n Log√≠stica - Base
 Quiero remover env√≠os cancelados de hojas de retiro programadas
 Para no gastar recursos en retiros innecesarios
Criterios de Aceptaci√≥n:
Env√≠os cancelados desaparecen autom√°ticamente de vista de planificaci√≥n
Si estaba en hoja de retiro ya generada, marca como "cancelado" pero mantiene en hist√≥rico
Ajusta capacidad utilizada del veh√≠culo
Notifica a conductor si hoja ya estaba asignada

HU-ID: EP7-HU4
 Como Backoffice de Problemas
 Quiero marcar env√≠o como "devolver a Stock" cuando no es entregable
 Para retornar mercader√≠a al dep√≥sito
Criterios de Aceptaci√≥n:
Opci√≥n disponible si estado = "delivery_failed" y se agotaron reintentos
Cambia estado a "returning"
Genera orden de devoluci√≥n con: env√≠o, motivo, dep√≥sito destino
Asigna a ruta de retorno al dep√≥sito
‚ö†Ô∏è Coordinaci√≥n manual con Stock para recepci√≥n f√≠sica (fuera del sistema)

HU-ID: EP7-HU5
 Como Conductor
 Quiero confirmar devoluci√≥n al dep√≥sito
 Para cerrar el ciclo de la devoluci√≥n
Criterios de Aceptaci√≥n:
Similar a retiro: escanea productos, genera acta de devoluci√≥n
Responsable de Stock firma acta
Cambia estado final a "returned" con timestamp
Genera acta de devoluci√≥n en PDF
‚ö†Ô∏è Coordinaci√≥n manual con Stock para reintegrar inventario

EP8 - Seguimiento, Eventos y Documentos
HU-ID: EP8-HU1
 Como Portal de Compras
 Quiero consultar estado actual y l√≠nea de tiempo de un env√≠o
 Para mostrar tracking detallado al cliente
Criterios de Aceptaci√≥n:
API GET /shipping/{id} devuelve: estado actual, ETA, eventos hist√≥ricos
Cada evento incluye: tipo, timestamp, descripci√≥n, ubicaci√≥n (si aplica)
Eventos m√≠nimos: created, pickup_scheduled, picked_up, out_for_delivery, delivered
Formato JSON est√°ndar, respuesta < 500ms

HU-ID: EP8-HU3
 Como M√≥dulo de Log√≠stica
 Quiero recalcular y actualizar ETA cuando ocurren demoras
 Para mantener expectativas realistas con el cliente
Criterios de Aceptaci√≥n:
Recalcula ETA si: retiro se retrasa >2hs, env√≠o no entregado, reprogramado
Nuevo ETA considera: tiempo transcurrido, pr√≥xima ventana disponible, carga operativa actual
Almacena historial de cambios de ETA en BD
Portal ver√° nuevo ETA al consultar GET /shipping/{id}

HU-ID: EP8-HU4
 Como Sistema
 Quiero generar etiqueta de env√≠o
 Para identificar un env√≠o
Criterios de Aceptaci√≥n:
Genera etiqueta al crear env√≠o
Almacena URL de etiqueta en registro del env√≠o

HU-ID: EP8-HU5
 Como Sistema
 Quiero generar acta de retiro con datos completos y firma digital
 Para documentar responsabilidad en transferencia de mercader√≠a
Criterios de Aceptaci√≥n:
Genera al confirmar retiro
Incluye: fecha/hora, dep√≥sito origen, conductor, veh√≠culo, lista detallada de productos/cantidades
√Årea de firma digital del responsable de Stock
Logo empresa, n√∫mero de acta √∫nico
PDF almacenado con acceso p√∫blico mediante URL

HU-ID: EP8-HU6
 Como Sistema
 Quiero generar POD (Proof of Delivery) con fotos del comprobante de entrega
 Para evidenciar entrega exitosa
Criterios de Aceptaci√≥n:
Genera al marcar entregado
Incluye: fecha/hora entrega, direcci√≥n, nombre receptor, firma digital, hasta 3 fotos
Geolocalizaci√≥n de punto de entrega
Marca de agua con timestamp en im√°genes
PDF + im√°genes originales accesibles por URL

EP9 - Torre de Control y Reportes
HU-ID: EP9-HU2
 Como Administrador General
 Quiero generar reporte de desempe√±o operativo con KPIs principales
 Para analizar eficiencia y tomar decisiones estrat√©gicas
Criterios de Aceptaci√≥n:
KPIs: Tasa de √©xito primer intento, Tiempo promedio retiro-entrega, Cumplimiento de ETA (%), Env√≠os entregados vs meta, Motivos top de no entrega
Filtros: rango de fechas, sucursal, servicio
Visualizaciones: gr√°ficos de barra, torta, l√≠nea de tendencia
Exportable a Excel y PDF
Genera en < 10 segundos para per√≠odos de hasta 30 d√≠as

HU-ID: EP9-HU3
 Como Administrador General
 Quiero ver reporte de trazabilidad completa de un env√≠o espec√≠fico
 Para auditar y resolver reclamos
Criterios de Aceptaci√≥n:
B√∫squeda por: ID env√≠o, ID orden, tel√©fono cliente
Muestra: todos los eventos con timestamp y usuario, cambios de estado, reasignaciones, documentos generados (etiqueta, actas, POD)
Enlaces a todos los documentos
Historial de comunicaciones con Stock y Portal
Exportable como PDF con fines legales

EP10 - Configuraci√≥n Operativa y Seguridad
HU-ID: EP10-HU1
 Como Administrador General
 Quiero configurar zonas de cobertura con pol√≠gonos geogr√°ficos o rangos de CP
 Para definir √°reas donde operamos
Criterios de Aceptaci√≥n:
Interfaz de mapa para dibujar pol√≠gonos
Alternativamente: carga CSV con lista de CPs cubiertos
Asigna zona a sucursal responsable
Marca zona como activa/inactiva
Valida direcci√≥n contra zonas al crear env√≠o
Rechaza creaci√≥n si direcci√≥n fuera de cobertura

HU-ID: EP10-HU2
 Como Administrador General
 Quiero registrar veh√≠culos con capacidad m√°xima (peso y volumen)
 Para controlar asignaciones y evitar sobrecarga
Criterios de Aceptaci√≥n:
Formulario: patente, tipo (moto/van/cami√≥n), capacidad peso (kg), volumen (m¬≥), sucursal asignada
Estado: activo/mantenimiento/inactivo
Valida unicidad de patente
Hist√≥rico de cambios de estado
No permite asignar env√≠os a veh√≠culos inactivos

HU-ID: EP10-HU3
 Como Administrador General
 Quiero definir ventanas operativas por dep√≥sito y sucursal
 Para coordinar horarios de retiro y entrega
Criterios de Aceptaci√≥n:
Configura por ubicaci√≥n: d√≠as de semana, horario inicio/fin
Permite definir franjas: ma√±ana (8-13h), tarde (13-18h), noche (18-21h)
Excepciones: feriados sin operaci√≥n
Valida que asignaciones respeten ventanas
Alertas si se intenta programar fuera de horario

HU-ID: EP10-HU4
 Como Administrador General
 Quiero configurar reglas de cotizaci√≥n por servicio (express/standard/econ√≥mico)
 Para calcular precios diferenciados
Criterios de Aceptaci√≥n:
Por servicio: tarifa base, tarifa por kg, tarifa por km, factor volum√©trico
Recargos opcionales: zona remota (+%), entrega urgente (+%), seguro por valor declarado
Vigencia desde/hasta fecha
Permite m√∫ltiples reglas activas (usa la m√°s reciente por defecto)
Simulador para probar c√°lculos con datos de ejemplo

HU-ID: EP10-HU5
 Como Administrador General
 Quiero mantener cat√°logo de motivos estandarizados de no entrega
 Para facilitar an√°lisis de causas ra√≠z
Criterios de Aceptaci√≥n:
Lista configurable de motivos: Ausente, Direcci√≥n incorrecta, Rechaz√≥, Zona insegura, etc.
Activo/inactivo por motivo
Orden de visualizaci√≥n en app conductor
Estad√≠stica: frecuencia
de uso de cada motivo
Permite agregar nuevos motivos con aprobaci√≥n

HU-ID: EP10-HU6
 Como Administrador General
 Quiero definir roles y permisos por funcionalidad
 Para controlar acceso seg√∫n responsabilidad de cada usuario
Criterios de Aceptaci√≥n:
Roles predefinidos: Admin General, Operaci√≥n Base, Conductor, Backoffice Problemas
Permisos granulares: ver env√≠os, crear, editar, cancelar, asignar veh√≠culos, configurar, ver reportes
Asigna rol a usuario al crear cuenta
Usuario puede tener m√∫ltiples roles
Valida permisos en cada acci√≥n (backend y frontend)

HU-ID: EP10-HU7
 Como Administrador General
 Quiero crear y editar usuarios con sus datos de acceso
 Para administrar el equipo operativo
Criterios de Aceptaci√≥n:
Formulario: nombre, email, tel√©fono, rol, sucursal asignada
Genera contrase√±a temporal al crear (env√≠a por email)
Obliga cambio de contrase√±a en primer login
Permite desactivar usuario (no elimina historial)
Log de auditor√≠a: qui√©n cre√≥/modific√≥ a qui√©n y cu√°ndo

HU-ID: EP10-HU10
 Como Sistema
 Quiero integrarme con Portal de Compras y Stock mediante APIs REST autenticadas
 Para intercambiar informaci√≥n de forma segura y confiable
Criterios de Aceptaci√≥n:
Autenticaci√≥n: API keys o OAuth 2.0
Endpoints documentados en OpenAPI/Swagger
Versionado de API (v1, v2) para cambios no breaking
Rate limiting: m√°x 1000 req/min por sistema externo
Logs de todas las llamadas entrantes/salientes
Timeout: 10 seg, responde 504 si excede
Retry autom√°tico con backoff exponencial en llamadas salientes

HU-ID: EP10-HU8
 Como Administrador General
 Quiero registrar tipos de transporte disponibles (cami√≥n, avi√≥n, tren, barco)
 Para ofrecer diferentes servicios de env√≠o con caracter√≠sticas y tiempos diferenciados
Criterios de Aceptaci√≥n:
Formulario: nombre (ej: "Cami√≥n"), c√≥digo (ej: "road"), descripci√≥n
Velocidad promedio (km/h) para c√°lculo de ETA
D√≠as estimados de entrega (rango: ej: "3-7 d√≠as")
Estado: activo/inactivo
Permite asociar tipo de transporte a servicios de cotizaci√≥n (express/standard/econ√≥mico)
Valida unicidad de c√≥digo
Lista muestra todos los tipos configurados con opci√≥n de editar/desactivar
No permite eliminar si hay env√≠os asociados, solo desactivar








15. LISTADO BREVE DE HISTORIAS DE USUARIO POR √âPICA
EP1 - Cotizaci√≥n Previa
EP1-HU1: Portal solicita cotizaci√≥n con direcci√≥n y productos
EP1-HU2: Consultar peso/dimensiones/dep√≥sito a Stock
EP1-HU3: Calcular precio por peso volum√©trico y distancia
EP1-HU4: Estimar ETA (retiro + entrega)

EP2 - Creaci√≥n de Env√≠o Post-Compra
EP2-HU1: Portal crea env√≠o post-compra con datos completos
EP2-HU2: Validar reserva activa en Stock
EP2-HU3: Calcular ETA inicial considerando carga operativa

EP3 - Retiro en Dep√≥sito de Stock
EP3-HU1: Ver env√≠os listos para retirar agrupados por dep√≥sito
EP3-HU2: Asignar veh√≠culo/conductor para retiro en dep√≥sito
EP3-HU3: Conductor ve hoja de retiro en app m√≥vil
EP3-HU4: Escanear c√≥digo de barras y cambiar estado a retirado

EP4 - Planificaci√≥n de √öltima Milla
EP4-HU1: Ver env√≠os pendientes de entrega
EP4-HU2: Planificar hoja de reparto validando capacidad
EP4-HU5: Conductor ve hoja de reparto con orden de paradas

EP5 - Ejecuci√≥n de Entrega (App Conductor)
EP5-HU1: Ver detalle completo de cada parada
EP5-HU2: Marcar entrega como "Entregado"
EP5-HU3: Marcar "No entregado" con motivo estandarizado

EP6 - Gesti√≥n de Problemas y Reintentos
EP6-HU1: Ver bandeja de env√≠os "delivery_failed"
EP6-HU3: Reprogramar env√≠o para reintento

EP7 - Cancelaci√≥n y Devoluci√≥n
EP7-HU1: Portal cancela env√≠o antes del retiro
EP7-HU3: Remover env√≠os cancelados de hojas de retiro
EP7-HU4: Marcar env√≠o como "devolver a Stock"
EP7-HU5: Conductor confirma devoluci√≥n al dep√≥sito

EP8 - Seguimiento, Eventos y Documentos
EP8-HU1: Portal consulta estado y l√≠nea de tiempo
EP8-HU3: Recalcular ETA cuando ocurren demoras
EP8-HU4: Generar etiqueta de env√≠o
EP8-HU5: Generar acta de retiro con firma digital
EP8-HU6: Generar POD con fotos del comprobante

EP9 - Torre de Control y Reportes
EP9-HU2: Reporte de desempe√±o operativo con KPIs
EP9-HU3: Reporte de trazabilidad completa de env√≠o

EP10 - Configuraci√≥n Operativa y Seguridad
EP10-HU1: Configurar zonas de cobertura (pol√≠gonos o CPs)
EP10-HU2: Registrar veh√≠culos con capacidad m√°xima
EP10-HU3: Definir ventanas operativas por dep√≥sito/sucursal
EP10-HU4: Configurar reglas de cotizaci√≥n por servicio
EP10-HU5: Mantener cat√°logo de motivos de no entrega
EP10-HU6: Definir roles y permisos
EP10-HU7: Crear y editar usuarios
EP10-HU8: Registrar tipos de transporte disponibles
EP10-HU10: Integraci√≥n con APIs REST autenticadas
















16. ORDEN DE REALIZACI√ìN DE HISTORIAS DE USUARIO

üìã SECUENCIA L√ìGICA (1-33)
EP10-HU6 - Definir roles y permisos
EP10-HU7 - Crear y editar usuarios
EP10-HU10 - Integraci√≥n con APIs REST autenticadas
EP10-HU1 - Configurar zonas de cobertura
EP10-HU8 - Registrar tipos de transporte disponibles
EP10-HU4 - Configurar reglas de cotizaci√≥n por servicio
EP10-HU2 - Registrar veh√≠culos con capacidad m√°xima
EP10-HU3 - Definir ventanas operativas por dep√≥sito/sucursal
EP10-HU5 - Mantener cat√°logo de motivos de no entrega
EP1-HU1 - Portal solicita cotizaci√≥n con direcci√≥n y productos
EP1-HU2 - Consultar peso/dimensiones/dep√≥sito a Stock
EP1-HU3 - Calcular precio por peso volum√©trico y distancia
EP1-HU4 - Estimar ETA (retiro + entrega)
EP2-HU1 - Portal crea env√≠o post-compra con datos completos
EP2-HU2 - Validar reserva activa en Stock
EP2-HU3 - Calcular ETA inicial considerando carga operativa
EP8-HU4 - Generar etiqueta de env√≠o
EP8-HU1 - Portal consulta estado y l√≠nea de tiempo
EP7-HU1 - Portal cancela env√≠o antes del retiro
EP7-HU3 - Remover env√≠os cancelados de hojas de retiro
EP3-HU1 - Ver env√≠os listos para retirar agrupados por dep√≥sito
EP3-HU2 - Asignar veh√≠culo/conductor para retiro en dep√≥sito
EP8-HU5 - Generar acta de retiro
EP4-HU1 - Ver env√≠os pendientes de entrega
EP4-HU2 - Planificar hoja de reparto validando capacidad
EP5-HU2 - Marcar entrega como "Entregado"
EP5-HU3 - Marcar "No entregado" con motivo estandarizado
EP6-HU1 - Ver bandeja de env√≠os "delivery_failed"
EP6-HU3 - Reprogramar env√≠o para reintento
EP8-HU3 - Recalcular ETA cuando ocurren demoras
EP7-HU4 - Marcar env√≠o como "devolver a Stock"
EP9-HU2 - Reporte de desempe√±o operativo con KPIs
EP9-HU3 - Reporte de trazabilidad completa de env√≠o
EP3-HU3 - Conductor ve hoja de retiro en app m√≥vil
EP3-HU4 - Escanear c√≥digo de barras y cambiar estado a retirado
EP4-HU5 - Conductor ve hoja de reparto con orden de paradas
EP5-HU1 - Ver detalle completo de cada parada
EP8-HU6 - Generar POD con fotos del comprobante
EP7-HU5 - Conductor confirma devoluci√≥n al dep√≥sito

